%function [subjectData,icoh_data_anal,export,a1,a3]=step_05a_nr_ac_icoh_subjectData(datestr,datafolder,gitpath,calc_icoh,calc_kin,calc_labpower,savefile)



% for debugging
datestr='2022_07_16'
datafolder='/home/rowlandn/nr_data_analysis/data_analyzed/eeg/gen_03/data';
gitpath='/home/rowlandn/nr_data_analysis/data_scripts/ac/Allen-EEG-analysis';
calc_icoh=true;
calc_kin=true;
calc_labpower=true;

% Detect subjects
sbj=dir(fullfile(datafolder,'pro000*'));
sbj={sbj.name}';

% % Load Gitpath
cd(gitpath)
allengit_genpaths(gitpath,'EEG')

% Define parameters
TOI={'pre-stim (baseline)','intrastim (5 min)','intrastim (15 min)','post-stim (5 min)'};
FOI_label={'Alpha','Beta','Gamma'};%can add more if you want
FOI_freq={{8,12},{13,30},{30,50}};
phases={'Hold','Prep','Reach'};
DOI={'stroke','healthy'};
stimtypes=[0,2];
stimname={'Sham','Stim'};

subjectData=[];
parfor s=1:numel(sbj)
    % Analysis folder
    anfold=fullfile(datafolder,sbj{s},'analysis');
    
    % Subject number
    subjectData(s).SubjectName=sbj{s};
    
    % Load S1 data
    disp(['Loading S1 data for...',sbj{s}])
    s1dat=load(fullfile(anfold,'S1-VR_preproc',[sbj{s},'_S1-VRdata_preprocessed.mat']));
    subjectData(s).sessioninfo=s1dat.sessioninfo;
    
    if calc_icoh||calc_labpower
        eeglabDat=load(fullfile(anfold,'EEGlab','EEGlab_Total.mat'));
        trials=fieldnames(eeglabDat.eegevents_ft.trials);
        for t=1:numel(trials)
            trialdat=eeglabDat.eegevents_ft.trials.(trials{t});
            for p=1:size(trialdat,1)
                if calc_icoh
                    
                    icoh_freq=trialdat(p).ft_iCoh.freq;
                    icoh_label=trialdat(p).ft_iCoh.labelcmb;
                    icoh_dim={'Label','Frequency','Reaches','Phase','Trial'};
                    if t==1 && p==1
                        tempicoh=nan(size(icoh_label,1),size(icoh_freq,2),12,size(trialdat,1),numel(trials));
                    end
                    tempicoh(:,:,1:size(trialdat(p).ft_iCoh.cohspctrm,3),p,t)=trialdat(p).ft_iCoh.cohspctrm;
                end
                if calc_labpower
                    power_times=trialdat(p).power.times;
                    power_freqs=trialdat(p).power.freqs;
                    chans=trialdat(p).chanlocs;
                    power_dim={'Frequency','Time','Channels','Phase','Trial'};
                    if t==1 && p==1
                        temppower=[];
                    end
                    temppower(:,:,:,p,t)=trialdat(p).power.ersp;
                end
            end
        end
        
        if calc_icoh
            disp(['Calculating EEGLAB icoh for...',sbj{s}])
            subjectData(s).iCoh.data=tempicoh;
            subjectData(s).iCoh.freq=icoh_freq;
            subjectData(s).iCoh.label=icoh_label;
            subjectData(s).iCoh.dim=icoh_dim;
        end
        
        if calc_labpower
            disp(['Calculating EEGLAB Power for...',sbj{s}])
            subjectData(s).power.data=temppower;
            subjectData(s).power.freq=power_freqs;
            subjectData(s).power.times=power_times;
            subjectData(s).power.chans=chans;
            subjectData(s).power.dim=power_dim;
        end
    end
    
    if calc_kin
        disp(['Calculating Kinematics for...',sbj{s}])
        metricDat=load(fullfile(anfold,'S2-metrics',[sbj{s},'_S2-Metrics.mat']));
        kinData=metricDat.metricdatraw.data;
        kinLabel=metricDat.metricdat.label;
        
        subjectData(s).kinematics.data=kinData;
        subjectData(s).kinematics.label=kinLabel;
    end
end
% I am switching from calculating the date to manually inputting it so it
% can be consistent across functions
% c=clock;
% y=sprintf('%0.5g',[c(1)]);
% m=sprintf('%0.5g',[c(2)]);
% d=sprintf('%0.5g',[c(3)]);
% if str2num(m)<10
%     m=['0',m];
% end
% if str2num(d)<10
%     d=['0',d];
% end
% date=[y,'_',m,'_',d];
subjectDatafilenm=['subjectData_',datestr]
eval([subjectDatafilenm,'=subjectData'])
cd(['~/nr_data_analysis/data_analyzed/eeg/gen_03/analysis_icoh/',datestr])

% if strcmp(savefile,'true')
%     save([subjectDatafilenm,'.mat'],subjectDatafilenm)
% elseif strcmp(savefile,'false')
% end

%% Analysis - column scatter? still not sure if this is ideal way to show this

icoh_data_anal=nr_ac_columnscatter_v01(datestr,subjectData,'iCoh',TOI,FOI_label,FOI_freq,phases,DOI,stimtypes,stimname,datafolder);
icoh_data_analfilenm=['icoh_data_anal_',datestr]
eval([icoh_data_analfilenm,'=icoh_data_anal'])
cd(['~/nr_data_analysis/data_analyzed/eeg/gen_03/analysis_icoh/',datestr])
save([icoh_data_analfilenm,'.mat'],icoh_data_analfilenm)

% I don't see why this couldn't be copied from above here and just save
% both at the same time
% if strcmp(savefile,'true')
%     save([subjectDatafilenm,'.mat'],subjectDatafilenm)
% elseif strcmp(savefile,'false')
% end

%% iCoh Bar 

%these are allen's bars - see below for mine
%the problems as always is that you have no output of the bar data and you
%don't know what is significant relative to what
export=[];
for f=1:numel(FOI_label)
    figure
    ax_count=1;
    for ph=1:numel(phases)
        for d=1:numel(DOI)
            ax=subplot(numel(phases),numel(DOI),ax_count);
            ax_count=ax_count+1;
            hold on
            
            clear b n
            n=[];
            anovaInput=[];
            for s=1:numel(stimtypes)
                session_data={subjectData.sessioninfo};
                sbj_idx=cellfun(@(x) x.stimamp==stimtypes(s),session_data) & cellfun(@(x) strcmp(x.dx,DOI{d}),session_data);
                tempdata=subjectData(sbj_idx);
                
                tempcoh=[];
                for i=1:numel(tempdata)
                    freq_idx=tempdata(i).iCoh.freq>=FOI_freq{f}{1}&tempdata(i).iCoh.freq<=FOI_freq{f}{2};
                    electrode_idx=all(strcmp(tempdata(i).iCoh.label,'C3')+strcmp(tempdata(i).iCoh.label,'C4'),2);
                    trial_idx=cellfun(@(x) any(strcmp(x,TOI)),tempdata(i).sessioninfo.trialnames);
                    tempcoh(i,:)=permute(mean(mean(tempdata(i).iCoh.data(electrode_idx,freq_idx,:,ph,trial_idx),2,'omitnan'),3,'omitnan'),[5 4 3 2 1]);
                end
                bardat=mean(tempcoh,1);
                sem=std(tempcoh,1,'omitnan')./sqrt(sum(~isnan(tempcoh),1));

                if s==1
                    xdat=(1:size(bardat,2))-0.2;
                else
                    xdat=(1:size(bardat,2))+0.2;
                end
                errorbar(xdat,bardat,sem,'LineStyle','none')

                b(s)=bar(xdat,bardat,0.2);

                n(s)=size(tempcoh,1);

                anovaInput{s}=tempcoh;
            end
            
            title(sprintf('%s - %s',DOI{d},phases{ph}))
            xticks([1:4])
            xticklabels({'Pre','Intra-5','Intra-15','Post-5'});
            ylabel('Beta iCoh')
            ylim([0 1])
            mixANOVA(anovaInput,b);
            export.(FOI_label{f}).(DOI{d})(ph,:)=anovaInput;

            legend(b,{['Sham n=',num2str(n(1))],['Stim n=',num2str(n(2))]})
        end
    end
    assignin('base','b',b)
    sgtitle(FOI_label{f})
    %figname=['iCoh Bar ',FOI_label{f}];
    figname=['ac_icoh_bar_',FOI_label{f}];
    savefig(gcf,figname)
    %close
end

% figname=['icoh_bar_',FOI_label{f},'_',datestr];
% sgtitle(FOI_label{f})
%     cd(['~/nr_data_analysis/data_analyzed/eeg/gen_03/analysis_icoh/',datestr])
%     %savefig(gcf,fullfile(savefolder,figname))
%     savefig(gcf,figname)
%     close

% here's mine - we will reformat and save the barplot data
for f=1:numel(FOI_label)
    for d=1:numel(DOI)
        for p=1:numel(phases)
            for t=1:numel(TOI)
                if d==1
                    eval(['icoh_data_anal.bar.',FOI_label{f},'.',DOI{d},'.',phases{p},...
                        '{1,1}(:,',num2str(t),')=icoh_data_anal.col.',FOI_label{f},...
                        '.',phases{p},'.data{',num2str(t),',1}(~isnan(icoh_data_anal.col.',FOI_label{f},...
                        '.',phases{p},'.data{',num2str(t),',1}(:,1)),1)'])
                    eval(['icoh_data_anal.bar.',FOI_label{f},'.',DOI{d},'.',phases{p},...
                        '{1,2}(:,',num2str(t),')=icoh_data_anal.col.',FOI_label{f},...
                        '.',phases{p},'.data{',num2str(t),',1}(~isnan(icoh_data_anal.col.',FOI_label{f},...
                        '.',phases{p},'.data{',num2str(t),',1}(:,2)),2)'])
                elseif d==2
                    eval(['icoh_data_anal.bar.',FOI_label{f},'.',DOI{d},'.',phases{p},...
                        '{1,1}(:,',num2str(t),')=icoh_data_anal.col.',FOI_label{f},...
                        '.',phases{p},'.data{',num2str(t),',1}(~isnan(icoh_data_anal.col.',FOI_label{f},...
                        '.',phases{p},'.data{',num2str(t),',1}(:,3)),3)'])
                    eval(['icoh_data_anal.bar.',FOI_label{f},'.',DOI{d},'.',phases{p},...
                        '{1,2}(:,',num2str(t),')=icoh_data_anal.col.',FOI_label{f},...
                        '.',phases{p},'.data{',num2str(t),',1}(~isnan(icoh_data_anal.col.',FOI_label{f},...
                        '.',phases{p},'.data{',num2str(t),',1}(:,4)),4)'])
                end
            end
        end
    end
end

%plot + stats
sp_vec=[1 3 5 2 4 6]
for f=1:numel(FOI_label)
    count=0
    figure
    for d=1:numel(DOI)
        for p=1:numel(phases)
            count=count+1
            set(gcf,'Position',[2346 633 583 437])
            subplot(3,2,sp_vec(count)); hold on
            eval(['b(1)=bar([0.8,1.8,2.8,3.8],mean(icoh_data_anal.bar.',FOI_label{f},'.',DOI{d},'.',phases{p},'{1,1}),0.2)'])
            eval(['errorbar([0.8,1.8,2.8,3.8],mean(icoh_data_anal.bar.',FOI_label{f},'.',DOI{d},'.',phases{p},'{1,1}),',...
                'std(icoh_data_anal.bar.',FOI_label{f},'.',DOI{d},'.',phases{p},'{1,1})/sqrt(size(icoh_data_anal.bar.',FOI_label{f},'.',DOI{d},'.',phases{p},'{1,1},1)),''.k'')'])

            eval(['b(2)=bar([1.2 2.2 3.2 4.2],mean(icoh_data_anal.bar.',FOI_label{f},'.',DOI{d},'.',phases{p},'{1,2}),0.2)'])
            eval(['errorbar([1.2 2.2 3.2 4.2],mean(icoh_data_anal.bar.',FOI_label{f},'.',DOI{d},'.',phases{p},'{1,2}),',...
                'std(icoh_data_anal.bar.',FOI_label{f},'.',DOI{d},'.Hold{1,2})/sqrt(size(icoh_data_anal.bar.',FOI_label{f},'.',DOI{d},'.',phases{p},'{1,2},1)),''.k'')'])
            ylabel('Beta iCoh')
            title([DOI{d},' - ',phases{p}])
            set(gca,'ylim',[0 1],'XTick',[1 2 3 4],'XTickLabel',['pre';'i5 ';'i15';'pos'])
            sgtitle(FOI_label{f})
            eval(['anovaInputa{1,1}=icoh_data_anal.bar.',FOI_label{f},'.',DOI{d},'.',phases{p},'{1,1}'])
            eval(['anovaInputa{1,2}=icoh_data_anal.bar.',FOI_label{f},'.',DOI{d},'.',phases{p},'{1,2}'])
            eval(['stats_mix_tbl_',FOI_label{f},'_',DOI{d},'_',phases{p},'=mixANOVA(anovaInputa,b)'])
        end
    end
    figname=['nr_icoh_bar_',FOI_label{f}];
    savefig(gcf,figname)%%%%%Have to add date here!!!
end
 
%% Linear regressions
kinlabel={'movementDuration','reactionTime','handpathlength','avgVelocity','maxVelocity','velocityPeaks','timeToMaxVelocity','timeToMaxVelocity_n','avgAcceleration','maxAcceleration','accuracy','normalizedJerk','IOC'};
for i=1:numel(kinlabel)
    eval(['icoh_data_anal.linreg.',kinlabel{i},'=nr_ac_linreg_v01(''2022_07_16'',subjectData,{''iCoh'',kinlabel{i}},TOI,FOI_label,FOI_freq,phases,DOI,stimtypes,stimname,datafolder)'])
end

%% icoh matrix
TOI={'pre-stim (baseline)','intrastim (5 min)','intrastim (15 min)','post-stim (5 min)'};
TOI_mod={'prestim','intra5','intra15','poststim5'};
phases={'Hold','Prep','Reach'};
DOI={'stroke','healthy'};
stimtypes=[0,2];
stimname={'Sham','Stim'};
electrodes={'A1','Fp1','F7','T3','T5','O1','F3','C3','P3','Fz','Cz','Pz','A2','Fp2','F8','T4','T6','O2','F4','C4','P4'};
norm=false;
FOI_label={'Alpha','Beta','Gamma'};
FOI_freq={{8,12},{13,30},{30,50}};
savefigures=true;
%outpath='C:\Users\allen\Desktop\RowlandFigs_11_22_21\Coh';
% analysisfolder='/home/rowlandn/nr_data_analysis/data_analyzed/eeg/gen_03/Analysis';
% iCohMatrixFolder=fullfile(analysisfolder,'iCohMatrix');
% mkdir(iCohMatrixFolder);
% outpath=iCohMatrixFolder


for f=[1 3]%1:numel(FOI_freq)
    for d=1:numel(DOI)
        %figure('WindowState','Maximized');
        figure; set(gcf,'Position',[469 686 593 430])
        set(gcf,'color','w');
        ax_count=1;
        clear h
        for t=1:numel(TOI)
            for p=1:numel(phases)
                
                tempdisease=[];
                tempstim=[];
                matcoh=[];
                
                for s=1:numel(sbj)
                    
                    % Calculate coherence
                    sbjicoh=subjectData(s).iCoh;
                    FOI_idx=sbjicoh.freq>=FOI_freq{f}{1} & sbjicoh.freq<=FOI_freq{f}{2};
                    TOI_idx=strcmp(subjectData(s).sessioninfo.trialnames,TOI{t});
                    tempdat=mean(mean(sbjicoh.data(:,FOI_idx,:,p,TOI_idx),2,'omitnan'),3,'omitnan');
                    tempmatcoh=nan(numel(electrodes));
                    for i=1:numel(tempdat)
                        templabel=sbjicoh.label(i,:);
                        tempmatcoh(strcmp(templabel{1},electrodes),strcmp(templabel{2},electrodes))=tempdat(i);
                        tempmatcoh(strcmp(templabel{2},electrodes),strcmp(templabel{1},electrodes))=tempdat(i);
                        
                        % Make diag nan
                        tempmatcoh(logical(diag(ones(size(tempmatcoh,1),1))))=nan;
                    end
                    matcoh(:,:,s)=tempmatcoh;
                    %eval(['matcoh_',FOI_label{f},'_',DOI{d},'_',TOI{t},'_',phases{p},'=matcoh;'])
                    
                    % Organize disease
                    tempdisease{s,1}=subjectData(s).sessioninfo.dx;
                    
                    % Organize stim
                    tempstim(s,1)=subjectData(s).sessioninfo.stimamp;
                end
                
                for s=1:numel(stimtypes)
                    h(ax_count)=subplot(numel(TOI),numel(phases)*numel(stimtypes),p+((s-1)*numel(phases))+((t-1)*numel(phases)*numel(stimtypes)));
                    ax_count=ax_count+1;
                    idx=tempstim==stimtypes(s)&strcmp(tempdisease,DOI{d});
                    eval(['icoh_data_anal.mat_all.',FOI_label{f},'.',DOI{d},'.',TOI_mod{t},'.',phases{p},'.',stimname{s},'=matcoh(:,:,idx);'])
                    %keep this is icoh_data_anal above is too large to save
                    eval(['data_grp_icohmat_',FOI_label{f},'_',DOI{d},'_',TOI_mod{t},'_',phases{p},'_',stimname{s},'=matcoh(:,:,idx);'])
                    imagescDat=mean(matcoh(:,:,idx),3);
                    if norm
                        imagescDat(logical(diag(ones(size(imagescDat,1),1))))=mean(imagescDat,'all');
                        imagescDat=mat2gray(imagescDat);
                        imagescDat(logical(diag(ones(size(imagescDat,1),1))))=nan;
                    end
                    imagesc(imagescDat,[0.4 0.7])
                    axis square
                    
                    colormap('jet');
                    xticks([1:numel(electrodes)])
                    xticklabels(electrodes)
                    yticks([1:numel(electrodes)])
                    yticklabels(electrodes)
                    title(phases{p})
                    subtitle(stimname{s})
                    ylabel(TOI{t})
                end
            end
        end
        
        % Colorbar
        cbh = colorbar(h(end));
        cbh.Location='layout';
        cbh.Position=[.9314 .11 .0281 .8150];
        ylabel(cbh,['Coherence ',FOI_label{f}],'FontSize',12)
        %%%%%%I wonder if for the normalized ones you have to open the
        %%%%%%scale to 0 to 1??? No tried it, it didn't work
        
        %I will move this to the main figure label
%         if norm
%             ylabel(cbh,['Normalized ',FOI_label{f},' Coherence'],'FontSize',12)
%             figtitle=sprintf('%s Coherence Matrix - %s Normalized',FOI_label{f},DOI{d});
%         else
%             ylabel(cbh,['Coherence ',FOI_label{f}],'FontSize',12)
%             figtitle=sprintf('%s Coherence Matrix - %s',FOI_label{f},DOI{d});
%         end
        
        % Title
        if norm
            sgtitle([DOI{d},' - ',FOI_label{f},' - all subjects (norm)'])
            figname=['nr_icoh_mat_all_',FOI_label{f},'_',DOI{d},'_norm_',datestr];
        else
            sgtitle([DOI{d},' - ',FOI_label{f},' - all subjects (%)'])
            figname=['nr_icoh_mat_sbj_all_elec_all_',FOI_label{f},'_',DOI{d},'_nonnorm_',datestr];
        end
        
        
%         % Save figure
        if savefigures
            cd(['~/nr_data_analysis/data_analyzed/eeg/gen_03/analysis_icoh/',datestr])
            savefig(gcf,figname)
           %saveas(gcf,fullfile(iCohMatrixFolder,[figtitle,'.jpeg']))
        end
        
        %close all
    end
end

%% Individual icoh matrices

%Create subject name variable
for s=1:size(subjectData,2)
    tempdisease{s,1}=subjectData(s).sessioninfo.dx;
    tempstim(s,1)=subjectData(s).sessioninfo.stimamp;
end

sbj_name=cell(6,numel(DOI)*numel(stimtypes));
sbjcount=1;
for d=1:numel(DOI)
    for s=1:numel(stimtypes)
        idx=strcmp(tempdisease,DOI{d})&tempstim==stimtypes(s);
        hold on
        ydat=tempdat(idx);
        sbjs=extractAfter({subjectData(idx).SubjectName},'pro00087153_00');
        sbj_name(1:numel(sbjs),sbjcount)=sbjs;
        sbjcount=sbjcount+1;
    end
end
   
% This is for individual matrices
for f=1:numel(FOI_label)
for sbj=1:numel(sbj_name)
    if isempty(sbj_name{sbj})
    else
        figure; set(gcf,'Position',[137 602 1128 608])

        if sbj>=1 & sbj<=6
            distype='stroke';
            stimtype='Sham';
        elseif sbj>=7 & sbj<=12
            distype='stroke';
            stimtype='Stim';
        elseif sbj>=13 & sbj<=18
            distype='healthy';
            stimtype='Sham';
        elseif sbj>=19 & sbj<=24
            distype='healthy';
            stimtype='Stim';
        end

        %extract subject row
        [sbj_r,sbj_c]=ind2sub(size(sbj_name),sbj);

        for t=1:numel(TOI)
            subplot(4,3,3*t-2)
            if t==1
                eval(['imagescDat=data_grp_icohmat_',FOI_label{f},'_',distype,'_prestim_Hold_',stimtype,'(:,:,sbj_r);']);
                eval(['imagescDat_p1_t1=data_grp_icohmat_',FOI_label{f},'_',distype,'_prestim_Hold_',stimtype,'(20,8,sbj_r);']);
                %imagescDat=data_grp_icohmat_',FOI_label{f},'_stroke_prestim_Hold_Stim(:,:,sbj);
            elseif t==2
                eval(['imagescDat=data_grp_icohmat_',FOI_label{f},'_',distype,'_intra5_Hold_',stimtype,'(:,:,sbj_r);']);
                eval(['imagescDat_p1_t2=data_grp_icohmat_',FOI_label{f},'_',distype,'_intra5_Hold_',stimtype,'(20,8,sbj_r);']);
                %imagescDat=data_grp_icohmat_',FOI_label{f},'_stroke_intra5_Hold_Stim(:,:,sbj);
            elseif t==3
                eval(['imagescDat=data_grp_icohmat_',FOI_label{f},'_',distype,'_intra15_Hold_',stimtype,'(:,:,sbj_r);']);
                eval(['imagescDat_p1_t3=data_grp_icohmat_',FOI_label{f},'_',distype,'_intra15_Hold_',stimtype,'(20,8,sbj_r);']);
                %imagescDat=data_grp_icohmat_',FOI_label{f},'_stroke_intra15_Hold_Stim(:,:,sbj);
            elseif t==4
                eval(['imagescDat=data_grp_icohmat_',FOI_label{f},'_',distype,'_poststim5_Hold_',stimtype,'(:,:,sbj_r);']);
                eval(['imagescDat_p1_t4=data_grp_icohmat_',FOI_label{f},'_',distype,'_poststim5_Hold_',stimtype,'(20,8,sbj_r);']);
                %imagescDat=data_grp_icohmat_',FOI_label{f},'_stroke_poststim5_Hold_Stim(:,:,sbj);
            end

        %             if norm
        %                 imagescDat1(logical(diag(ones(size(imagescDat1,1),1))))=mean(imagescDat1,'all');
        %                 imagescDat1=mat2gray(imagescDat1);
        %                 imagescDat1(logical(diag(ones(size(imagescDat1,1),1))))=nan;
        %             end
            imagesc(imagescDat,[0.4 0.7])
            %axis square

            colormap('jet');
            xticks([1:numel(electrodes)])
            xticklabels(electrodes)
            yticks([1:numel(electrodes)])
            yticklabels(electrodes)
            title(phases{1})%p
            %subtitle(stimname{2})%s
            subtitle(stimtype)
            ylabel(TOI{t})

        end

        for t=1:numel(TOI)
            subplot(4,3,3*t-1)
            if t==1
                eval(['imagescDat=data_grp_icohmat_',FOI_label{f},'_',distype,'_prestim_Prep_',stimtype,'(:,:,sbj_r);']);
                eval(['imagescDat_p2_t1=data_grp_icohmat_',FOI_label{f},'_',distype,'_prestim_Prep_',stimtype,'(20,8,sbj_r);']);
                %imagescDat=data_grp_icohmat_',FOI_label{f},'_stroke_prestim_Prep_Stim(:,:,sbj);
            elseif t==2
                eval(['imagescDat=data_grp_icohmat_',FOI_label{f},'_',distype,'_intra5_Prep_',stimtype,'(:,:,sbj_r);']);
                eval(['imagescDat_p2_t2=data_grp_icohmat_',FOI_label{f},'_',distype,'_intra5_Prep_',stimtype,'(20,8,sbj_r);']);
                %imagescDat=data_grp_icohmat_',FOI_label{f},'_stroke_intra5_Prep_Stim(:,:,sbj);
            elseif t==3
                eval(['imagescDat=data_grp_icohmat_',FOI_label{f},'_',distype,'_intra15_Prep_',stimtype,'(:,:,sbj_r);']);
                eval(['imagescDat_p2_t3=data_grp_icohmat_',FOI_label{f},'_',distype,'_intra15_Prep_',stimtype,'(20,8,sbj_r);']);
                %imagescDat=data_grp_icohmat_',FOI_label{f},'_stroke_intra15_Prep_Stim(:,:,sbj);
            elseif t==4
                eval(['imagescDat=data_grp_icohmat_',FOI_label{f},'_',distype,'_poststim5_Prep_',stimtype,'(:,:,sbj_r);']);
                eval(['imagescDat_p2_t4=data_grp_icohmat_',FOI_label{f},'_',distype,'_poststim5_Prep_',stimtype,'(20,8,sbj_r);']);
                %imagescDat=data_grp_icohmat_',FOI_label{f},'_stroke_poststim5_Prep_Stim(:,:,sbj);
            end

    %             if norm
    %                 imagescDat1(logical(diag(ones(size(imagescDat1,1),1))))=mean(imagescDat1,'all');
    %                 imagescDat1=mat2gray(imagescDat1);
    %                 imagescDat1(logical(diag(ones(size(imagescDat1,1),1))))=nan;
    %             end
            imagesc(imagescDat,[0.4 0.7])
            %axis square

            colormap('jet');
            xticks([1:numel(electrodes)])
            xticklabels(electrodes)
            yticks([1:numel(electrodes)])
            yticklabels(electrodes)
            title(phases{2})%p
            %subtitle(stimname{2})%s
            subtitle(stimtype)
            ylabel(TOI{t})

        end

        for t=1:numel(TOI)
            subplot(4,3,3*t)
            if t==1
                eval(['imagescDat=data_grp_icohmat_',FOI_label{f},'_',distype,'_prestim_Reach_',stimtype,'(:,:,sbj_r);']);
                eval(['imagescDat_p3_t1=data_grp_icohmat_',FOI_label{f},'_',distype,'_prestim_Reach_',stimtype,'(20,8,sbj_r);']);
                %imagescDat=data_grp_icohmat_',FOI_label{f},'_stroke_prestim_Reach_Stim(:,:,sbj);
            elseif t==2
                eval(['imagescDat=data_grp_icohmat_',FOI_label{f},'_',distype,'_intra5_Reach_',stimtype,'(:,:,sbj_r);']);
                eval(['imagescDat_p3_t2=data_grp_icohmat_',FOI_label{f},'_',distype,'_intra5_Reach_',stimtype,'(20,8,sbj_r);']);
                %imagescDat=data_grp_icohmat_',FOI_label{f},'_stroke_intra5_Reach_Stim(:,:,sbj);
            elseif t==3
                eval(['imagescDat=data_grp_icohmat_',FOI_label{f},'_',distype,'_intra15_Reach_',stimtype,'(:,:,sbj_r);']);
                eval(['imagescDat_p3_t3=data_grp_icohmat_',FOI_label{f},'_',distype,'_intra15_Reach_',stimtype,'(20,8,sbj_r);']);
                %imagescDat=data_grp_icohmat_',FOI_label{f},'_stroke_intra15_Reach_Stim(:,:,sbj);
            elseif t==4
                eval(['imagescDat=data_grp_icohmat_',FOI_label{f},'_',distype,'_poststim5_Reach_',stimtype,'(:,:,sbj_r);']);
                eval(['imagescDat_p3_t4=data_grp_icohmat_',FOI_label{f},'_',distype,'_poststim5_Reach_',stimtype,'(20,8,sbj_r);']);
                %imagescDat=data_grp_icohmat_',FOI_label{f},'_stroke_poststim5_Reach_Stim(:,:,sbj);
            end

    %             if norm
    %                 imagescDat1(logical(diag(ones(size(imagescDat1,1),1))))=mean(imagescDat1,'all');
    %                 imagescDat1=mat2gray(imagescDat1);
    %                 imagescDat1(logical(diag(ones(size(imagescDat1,1),1))))=nan;
    %             end
            imagesc(imagescDat,[0.4 0.7])
            %axis square

            colormap('jet');
            xticks([1:numel(electrodes)])
            xticklabels(electrodes)
            yticks([1:numel(electrodes)])
            yticklabels(electrodes)
            title(phases{3})%p
            %subtitle(stimname{2})%s
            subtitle(stimtype)
            ylabel(TOI{t})

        end
        %sbj
        sgtitle([sbj_name{sbj},' ',distype,' ',stimtype,' - ',FOI_label{f}])
        %[sbj_name{sbj},' ',distype,' ',stimtype]

        %Colorbar
        %cbh = colorbar(h(end));
        cbh = colorbar;
        cbh.Location='layout';
        cbh.Position=[.9314 .11 .0281 .8150];
        ylabel(cbh,'Coherence','FontSize',12)
        %f=2;
        if norm
            ylabel(cbh,['Normalized ',FOI_label{f},' Coherence'],'FontSize',12)
            figtitle=sprintf('%s Coherence Matrix - %s Normalized',FOI_label{f},DOI{d});
        else
            ylabel(cbh,['Coherence ',FOI_label{f}],'FontSize',12)
            figtitle=sprintf('%s Coherence Matrix - %s',FOI_label{f},DOI{d});
        end
        
        eval(['imagescDat_ind_',FOI_label{f},'_c3_c4{sbj_r,sbj_c}(1,1)=imagescDat_p1_t1;'])
        eval(['imagescDat_ind_',FOI_label{f},'_c3_c4{sbj_r,sbj_c}(2,1)=imagescDat_p1_t2;'])
        eval(['imagescDat_ind_',FOI_label{f},'_c3_c4{sbj_r,sbj_c}(3,1)=imagescDat_p1_t3;'])
        eval(['imagescDat_ind_',FOI_label{f},'_c3_c4{sbj_r,sbj_c}(4,1)=imagescDat_p1_t4;'])

        eval(['imagescDat_ind_',FOI_label{f},'_c3_c4{sbj_r,sbj_c}(1,2)=imagescDat_p2_t1;'])
        eval(['imagescDat_ind_',FOI_label{f},'_c3_c4{sbj_r,sbj_c}(2,2)=imagescDat_p2_t2;'])
        eval(['imagescDat_ind_',FOI_label{f},'_c3_c4{sbj_r,sbj_c}(3,2)=imagescDat_p2_t3;'])
        eval(['imagescDat_ind_',FOI_label{f},'_c3_c4{sbj_r,sbj_c}(4,2)=imagescDat_p2_t4;'])

        eval(['imagescDat_ind_',FOI_label{f},'_c3_c4{sbj_r,sbj_c}(1,3)=imagescDat_p3_t1;'])
        eval(['imagescDat_ind_',FOI_label{f},'_c3_c4{sbj_r,sbj_c}(2,3)=imagescDat_p3_t2;'])
        eval(['imagescDat_ind_',FOI_label{f},'_c3_c4{sbj_r,sbj_c}(3,3)=imagescDat_p3_t3;'])
        eval(['imagescDat_ind_',FOI_label{f},'_c3_c4{sbj_r,sbj_c}(4,3)=imagescDat_p3_t4;'])
    
        figname=['nr_icoh_mat_sbj_',sbj_name{sbj},'_elec_all_',FOI_label{f},'_',DOI{d},'_',stimtype,'_nonnorm_',datestr];
        cd(['~/nr_data_analysis/data_analyzed/eeg/gen_03/analysis_icoh/',datestr])
        savefig(gcf,figname)
   end
end
end

%This is for ind c3-4 plots
for f=1:numel(FOI_label)
    figure; set(gcf,'Position',[2133 109 1214 834])
    sp_vec=[1,7,13,19,2,8,14,20,3,9,15,21,4,10,16,22,5,11,17,23,NaN,NaN,NaN,24]

for sbj=1:numel(sbj_name)
    %if isempty(sbj_name{sbj})
    if isnan(sp_vec(sbj))
    else
        subplot(6,4,sbj)
        eval(['imagesc(imagescDat_ind_',FOI_label{f},'_c3_c4{sp_vec(sbj)},[0.4 0.7])'])
        ylabel(sbj_name{sp_vec(sbj)},'Fontweight','bold')
        colormap('jet');
        set(gca,'YTick',[1:4],'YTickLabel',['pre';'i05';'i15';'pos'],'XTick',[1:3],'XTickLabel',['H';'P';'R'])
        if sbj==1
            title('stroke')
            subtitle ('sham')
        elseif sbj==2
            title('stroke')
            subtitle ('stim')
        elseif sbj==3
            title('healthy')
            subtitle ('sham')
        elseif sbj==4
            title('healthy')
            subtitle ('stim')
        end
        sgtitle(FOI_label{f})
            
        %Colorbar
        cbh = colorbar;
        cbh.Location='layout';
        cbh.Position=[.9314 .11 .0281 .8150];
        ylabel(cbh,'Coherence','FontSize',12)
        %f=2;
        if norm
            ylabel(cbh,['Normalized ',FOI_label{f},' C3-4 Coherence'],'FontSize',12)
            figtitle=sprintf('%s Coherence Matrix - %s Normalized',FOI_label{f},DOI{d});
        else
            ylabel(cbh,['C3-4 Coherence ',FOI_label{f}],'FontSize',12)
            figtitle=sprintf('%s Coherence Matrix - %s',FOI_label{f},DOI{d});
        end
    end
    cd(['~/nr_data_analysis/data_analyzed/eeg/gen_03/analysis_icoh/',datestr])
    figname=['nr_icoh_mat_sbj_all_elec_c3c4_',FOI_label{f},'_nonnorm_',datestr];
    savefig(gcf,figname)
end
end

%% put titles and subtitles on columns
% 
%tomorrow
%use your multcompare function on the first plot and then plot pvalues on
%2nd plot
%then do for all frequencies - alpha, beta, gamma




%then plot means in 2 or more ways
%then perhaps plot percentages

%for f=1:numel(FOI_label)
for sbj=1:numel(imagescDat_ind_c3_c4)
    if isempty(sbj_name{sbj})
    else
        %for 
            
            if sbj>=1 & sbj<=6
                distype='stroke';
                stimtype='sham';
                [sbj_r,sbj_c]=ind2sub(size(sbj_name),sbj);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pre_hold(sbj_r)=imagescDat_ind_c3_c4{sbj_r,1}(1,1);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i05_hold(sbj_r)=imagescDat_ind_c3_c4{sbj_r,1}(2,1);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i15_hold(sbj_r)=imagescDat_ind_c3_c4{sbj_r,1}(3,1);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pos_hold(sbj_r)=imagescDat_ind_c3_c4{sbj_r,1}(4,1);']);
                
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pre_prep(sbj_r)=imagescDat_ind_c3_c4{sbj_r,1}(1,2);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i05_prep(sbj_r)=imagescDat_ind_c3_c4{sbj_r,1}(2,2);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i15_prep(sbj_r)=imagescDat_ind_c3_c4{sbj_r,1}(3,2);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pos_prep(sbj_r)=imagescDat_ind_c3_c4{sbj_r,1}(4,2);']);
                
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pre_reac(sbj_r)=imagescDat_ind_c3_c4{sbj_r,1}(1,3);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i05_reac(sbj_r)=imagescDat_ind_c3_c4{sbj_r,1}(2,3);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i15_reac(sbj_r)=imagescDat_ind_c3_c4{sbj_r,1}(3,3);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pos_reac(sbj_r)=imagescDat_ind_c3_c4{sbj_r,1}(4,3);']);
                
            elseif sbj>=7 & sbj<=12
                distype='stroke';
                stimtype='stim';
                [sbj_r,sbj_c]=ind2sub(size(sbj_name),sbj);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pre_hold(sbj_r)=imagescDat_ind_c3_c4{sbj_r,2}(1,1);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i05_hold(sbj_r)=imagescDat_ind_c3_c4{sbj_r,2}(2,1);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i15_hold(sbj_r)=imagescDat_ind_c3_c4{sbj_r,2}(3,1);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pos_hold(sbj_r)=imagescDat_ind_c3_c4{sbj_r,2}(4,1);']);
                
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pre_prep(sbj_r)=imagescDat_ind_c3_c4{sbj_r,2}(1,2);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i05_prep(sbj_r)=imagescDat_ind_c3_c4{sbj_r,2}(2,2);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i15_prep(sbj_r)=imagescDat_ind_c3_c4{sbj_r,2}(3,2);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pos_prep(sbj_r)=imagescDat_ind_c3_c4{sbj_r,2}(4,2);']);
                
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pre_reac(sbj_r)=imagescDat_ind_c3_c4{sbj_r,2}(1,3);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i05_reac(sbj_r)=imagescDat_ind_c3_c4{sbj_r,2}(2,3);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i15_reac(sbj_r)=imagescDat_ind_c3_c4{sbj_r,2}(3,3);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pos_reac(sbj_r)=imagescDat_ind_c3_c4{sbj_r,2}(4,3);']);
            elseif sbj>=13 & sbj<=18
                distype='healthy';
                stimtype='sham';
                [sbj_r,sbj_c]=ind2sub(size(sbj_name),sbj);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pre_hold(sbj_r)=imagescDat_ind_c3_c4{sbj_r,3}(1,1);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i05_hold(sbj_r)=imagescDat_ind_c3_c4{sbj_r,3}(2,1);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i15_hold(sbj_r)=imagescDat_ind_c3_c4{sbj_r,3}(3,1);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pos_hold(sbj_r)=imagescDat_ind_c3_c4{sbj_r,3}(4,1);']);
                
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pre_prep(sbj_r)=imagescDat_ind_c3_c4{sbj_r,3}(1,2);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i05_prep(sbj_r)=imagescDat_ind_c3_c4{sbj_r,3}(2,2);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i15_prep(sbj_r)=imagescDat_ind_c3_c4{sbj_r,3}(3,2);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pos_prep(sbj_r)=imagescDat_ind_c3_c4{sbj_r,3}(4,2);']);
                
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pre_reac(sbj_r)=imagescDat_ind_c3_c4{sbj_r,3}(1,3);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i05_reac(sbj_r)=imagescDat_ind_c3_c4{sbj_r,3}(2,3);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i15_reac(sbj_r)=imagescDat_ind_c3_c4{sbj_r,3}(3,3);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pos_reac(sbj_r)=imagescDat_ind_c3_c4{sbj_r,3}(4,3);']); 
            elseif sbj>=19 & sbj<=24
                distype='healthy';
                stimtype='stim';
                [sbj_r,sbj_c]=ind2sub(size(sbj_name),sbj);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pre_hold(sbj_r)=imagescDat_ind_c3_c4{sbj_r,4}(1,1);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i05_hold(sbj_r)=imagescDat_ind_c3_c4{sbj_r,4}(2,1);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i15_hold(sbj_r)=imagescDat_ind_c3_c4{sbj_r,4}(3,1);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pos_hold(sbj_r)=imagescDat_ind_c3_c4{sbj_r,4}(4,1);']);
                
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pre_prep(sbj_r)=imagescDat_ind_c3_c4{sbj_r,4}(1,2);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i05_prep(sbj_r)=imagescDat_ind_c3_c4{sbj_r,4}(2,2);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i15_prep(sbj_r)=imagescDat_ind_c3_c4{sbj_r,4}(3,2);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pos_prep(sbj_r)=imagescDat_ind_c3_c4{sbj_r,4}(4,2);']);
                
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pre_reac(sbj_r)=imagescDat_ind_c3_c4{sbj_r,4}(1,3);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i05_reac(sbj_r)=imagescDat_ind_c3_c4{sbj_r,4}(2,3);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_i15_reac(sbj_r)=imagescDat_ind_c3_c4{sbj_r,4}(3,3);']);
                eval(['all_imagescDat_ind_c3_c4_beta_',distype,'_',stimtype,'_pos_reac(sbj_r)=imagescDat_ind_c3_c4{sbj_r,4}(4,3);']); 
            end
    end
end

distype={'stroke';'healthy'};
stimtype={'sham';'stim'};
timetype={'pre';'i05';'i15';'pos'};
phasetype={'hold';'prep';'reac'};

for i=1:size(distype,1)
    for j=1:size(stimtype,1)
        for k=1:size(timetype,1)
            for l=1:size(phasetype,1)
                eval(['mean_all_imagescDat_ind_c3_c4_beta_',distype{i},'_',stimtype{j},'_',timetype{k},'_',phasetype{l},...
                    '=mean(all_imagescDat_ind_c3_c4_beta_',distype{i},'_',stimtype{j},'_',timetype{k},'_',phasetype{l},')'])
                eval(['se_all_imagescDat_ind_c3_c4_beta_',distype{i},'_',stimtype{j},'_',timetype{k},'_',phasetype{l},...
                    '=std(all_imagescDat_ind_c3_c4_beta_',distype{i},'_',stimtype{j},'_',timetype{k},'_',phasetype{l},')',...
                    '/sqrt(size(all_imagescDat_ind_c3_c4_beta_',distype{i},'_',stimtype{j},'_',timetype{k},'_',phasetype{l},',2))'])
                
            
            end
        end
    end
end

for i=1:size(distype,1)
    for j=1:size(stimtype,1)
        for l=1:size(phasetype,1)
            eval(['all_times_c3_c4_beta_',distype{i},'_',stimtype{j},'_',phasetype{l},'=[',...
                    'all_imagescDat_ind_c3_c4_beta_',distype{i},'_',stimtype{j},'_pre','_',phasetype{l},''','...
                    'all_imagescDat_ind_c3_c4_beta_',distype{i},'_',stimtype{j},'_i05','_',phasetype{l},''','...
                    'all_imagescDat_ind_c3_c4_beta_',distype{i},'_',stimtype{j},'_i15','_',phasetype{l},''','...
                    'all_imagescDat_ind_c3_c4_beta_',distype{i},'_',stimtype{j},'_pos','_',phasetype{l},''']'])
            eval(['[f_p_all_times_c3_c4_beta_',distype{i},'_',stimtype{j},'_',phasetype{l},...
                ',f_tab_all_times_c3_c4_beta_',distype{i},'_',stimtype{j},'_',phasetype{l},...
                ',f_stats_all_times_c3_c4_beta_',distype{i},'_',stimtype{j},'_',phasetype{l},']=',...
                'friedman(all_times_c3_c4_beta_',distype{i},'_',stimtype{j},'_',phasetype{l},')'])
        end
    end
end
   
for i=1:size(distype,1)
    for j=1:size(stimtype,1)
        for t=1:size(timetype,1)
            eval(['all_phases_c3_c4_beta_',distype{i},'_',stimtype{j},'_',timetype{t},'=[',...
                    'all_imagescDat_ind_c3_c4_beta_',distype{i},'_',stimtype{j},'_',timetype{t},'_hold',''','...
                    'all_imagescDat_ind_c3_c4_beta_',distype{i},'_',stimtype{j},'_',timetype{t},'_prep',''','...
                    'all_imagescDat_ind_c3_c4_beta_',distype{i},'_',stimtype{j},'_',timetype{t},'_reac',''']'])
            eval(['[f_p_all_phases_c3_c4_beta_',distype{i},'_',stimtype{j},'_',timetype{t},...
                ',f_tab_all_phases_c3_c4_beta_',distype{i},'_',stimtype{j},'_',timetype{t},...
                ',f_stats_all_phases_c3_c4_beta_',distype{i},'_',stimtype{j},'_',timetype{t},']=',...
                'friedman(all_phases_c3_c4_beta_',distype{i},'_',stimtype{j},'_',timetype{t},')'])
        end
    end
end
   
figure; set(gcf,'Position',[51 626 1214 571])
%Stroke sham
subplot(7,4,1); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_hold ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_hold])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_hold ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_hold],...
    [se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_hold se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_hold ,...
    se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_hold se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_hold],'.k')
set(gca,'XTick',[1:4],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Stroke Sham Hold')

mc_all_times_beta_stroke_sham_hold=nr_multcompare_ind_tdcs_plot2(f_stats_all_times_c3_c4_beta_stroke_sham_hold,...
    f_p_all_times_c3_c4_beta_stroke_sham_hold,0.5)

subplot(7,4,5); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_prep mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_prep mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_prep])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_prep mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_prep mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_prep],...
    [se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_prep se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_prep ,...
    se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_prep se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_prep],'.k')
set(gca,'XTick',[1:4],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Stroke Sham Prep')

mc_all_times_beta_stroke_sham_prep=nr_multcompare_ind_tdcs_plot2(f_stats_all_times_c3_c4_beta_stroke_sham_prep,...
    f_p_all_times_c3_c4_beta_stroke_sham_prep,0.5)


subplot(7,4,9); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_reac mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_reac ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_reac mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_reac])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_reac mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_reac ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_reac mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_reac],...
    [se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_reac se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_reac ,...
    se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_reac se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_reac],'.k')
set(gca,'XTick',[1:4],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Stroke Sham Reach')

mc_all_times_beta_stroke_sham_reac=nr_multcompare_ind_tdcs_plot2(f_stats_all_times_c3_c4_beta_stroke_sham_reac,...
    f_p_all_times_c3_c4_beta_stroke_sham_reac,0.5)

subplot(7,4,13); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_reac])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_reac],...
    [se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_hold se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_prep ,...
    se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_reac],'.k')
set(gca,'XTick',[1:3],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Stroke Sham Pre')

mc_all_phases_beta_stroke_sham_pre=nr_multcompare_ind_tdcs_plot2(f_stats_all_phases_c3_c4_beta_stroke_sham_pre,...
    f_p_all_phases_c3_c4_beta_stroke_sham_pre,0.5)

subplot(7,4,17); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_reac])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_reac],...
    [se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_hold se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_prep ,...
    se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_reac],'.k')
set(gca,'XTick',[1:3],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Stroke Sham i05')

mc_all_phases_beta_stroke_sham_i05=nr_multcompare_ind_tdcs_plot2(f_stats_all_phases_c3_c4_beta_stroke_sham_i05,...
    f_p_all_phases_c3_c4_beta_stroke_sham_i05,0.5)

subplot(7,4,21); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_reac])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_reac],...
    [se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_hold se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_prep ,...
    se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_reac],'.k')
set(gca,'XTick',[1:3],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Stroke Sham i15')

mc_all_phases_beta_stroke_sham_i15=nr_multcompare_ind_tdcs_plot2(f_stats_all_phases_c3_c4_beta_stroke_sham_i15,...
    f_p_all_phases_c3_c4_beta_stroke_sham_i15,0.5)

subplot(7,4,25); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_reac])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_reac],...
    [se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_hold se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_prep ,...
    se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_reac],'.k')
set(gca,'XTick',[1:3],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Stroke Sham pos')

mc_all_phases_beta_stroke_sham_pos=nr_multcompare_ind_tdcs_plot2(f_stats_all_phases_c3_c4_beta_stroke_sham_pos,...
    f_p_all_phases_c3_c4_beta_stroke_sham_pos,0.5)

%stroke stim
subplot(7,4,2); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_hold ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_hold])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_hold ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_hold],...
    [se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_hold se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_hold ,...
    se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_hold se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_hold],'.k')
set(gca,'XTick',[1:4],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Stroke Stim Hold')

mc_all_times_beta_stroke_stim_hold=nr_multcompare_ind_tdcs_plot2(f_stats_all_times_c3_c4_beta_stroke_stim_hold,...
    f_p_all_times_c3_c4_beta_stroke_stim_hold,0.5)

subplot(7,4,6); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_prep mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_prep mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_prep])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_prep mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_prep mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_prep],...
    [se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_prep se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_prep ,...
    se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_prep se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_prep],'.k')
set(gca,'XTick',[1:4],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Stroke Stim Prep')

mc_all_times_beta_stroke_stim_prep=nr_multcompare_ind_tdcs_plot2(f_stats_all_times_c3_c4_beta_stroke_stim_prep,...
    f_p_all_times_c3_c4_beta_stroke_stim_prep,0.5)

subplot(7,4,10); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_reac mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_reac ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_reac mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_reac])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_reac mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_reac ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_reac mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_reac],...
    [se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_reac se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_reac ,...
    se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_reac se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_reac],'.k')
set(gca,'XTick',[1:4],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Stroke Stim Reach')

mc_all_times_beta_stroke_stim_reac=nr_multcompare_ind_tdcs_plot2(f_stats_all_times_c3_c4_beta_stroke_stim_reac,...
    f_p_all_times_c3_c4_beta_stroke_stim_reac,0.5)

subplot(7,4,14); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_reac])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_reac],...
    [se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_hold se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_prep ,...
    se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_reac],'.k')
set(gca,'XTick',[1:3],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Stroke Stim Pre')

mc_all_phases_beta_stroke_stim_pre=nr_multcompare_ind_tdcs_plot2(f_stats_all_phases_c3_c4_beta_stroke_stim_pre,...
    f_p_all_phases_c3_c4_beta_stroke_stim_pre,0.5)

subplot(7,4,18); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_reac])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_reac],...
    [se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_hold se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_prep ,...
    se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_reac],'.k')
set(gca,'XTick',[1:3],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Stroke Stim i05')

mc_all_phases_beta_stroke_stim_i05=nr_multcompare_ind_tdcs_plot2(f_stats_all_phases_c3_c4_beta_stroke_stim_i05,...
    f_p_all_phases_c3_c4_beta_stroke_stim_i05,0.5)

subplot(7,4,22); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_reac])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_reac],...
    [se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_hold se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_prep ,...
    se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_reac],'.k')
set(gca,'XTick',[1:3],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Stroke Stim i15')

mc_all_phases_beta_stroke_stim_i15=nr_multcompare_ind_tdcs_plot2(f_stats_all_phases_c3_c4_beta_stroke_stim_i15,...
    f_p_all_phases_c3_c4_beta_stroke_stim_i15,0.5)

subplot(7,4,26); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_reac])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_hold mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_reac],...
    [se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_hold se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_prep ,...
    se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_reac],'.k')
set(gca,'XTick',[1:3],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Stroke Stim pos')

mc_all_phases_beta_stroke_stim_pos=nr_multcompare_ind_tdcs_plot2(f_stats_all_phases_c3_c4_beta_stroke_stim_pos,...
    f_p_all_phases_c3_c4_beta_stroke_stim_pos,0.5)

%healthy sham
subplot(7,4,3); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_hold ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_hold])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_hold ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_hold],...
    [se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_hold se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_hold ,...
    se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_hold se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_hold],'.k')
set(gca,'XTick',[1:4],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Healthy Sham Hold')

mc_all_times_beta_healthy_sham_hold=nr_multcompare_ind_tdcs_plot2(f_stats_all_times_c3_c4_beta_healthy_sham_hold,...
    f_p_all_times_c3_c4_beta_healthy_sham_hold,0.5)

subplot(7,4,7); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_prep mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_prep mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_prep])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_prep mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_prep mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_prep],...
    [se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_prep se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_prep ,...
    se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_prep se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_prep],'.k')
set(gca,'XTick',[1:4],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Healthy Sham Prep')

mc_all_times_beta_healthy_sham_prep=nr_multcompare_ind_tdcs_plot2(f_stats_all_times_c3_c4_beta_healthy_sham_prep,...
    f_p_all_times_c3_c4_beta_healthy_sham_prep,0.5)

subplot(7,4,11); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_reac mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_reac ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_reac mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_reac])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_reac mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_reac ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_reac mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_reac],...
    [se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_reac se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_reac ,...
    se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_reac se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_reac],'.k')
set(gca,'XTick',[1:4],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Healthy Sham Reach')

mc_all_times_beta_healthy_sham_reac=nr_multcompare_ind_tdcs_plot2(f_stats_all_times_c3_c4_beta_healthy_sham_reac,...
    f_p_all_times_c3_c4_beta_healthy_sham_reac,0.5)

subplot(7,4,15); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_reac])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_reac],...
    [se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_hold se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_prep ,...
    se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_reac],'.k')
set(gca,'XTick',[1:3],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Healthy Sham Pre')

mc_all_phases_beta_healthy_sham_pre=nr_multcompare_ind_tdcs_plot2(f_stats_all_phases_c3_c4_beta_healthy_sham_pre,...
    f_p_all_phases_c3_c4_beta_healthy_sham_pre,0.5)

subplot(7,4,19); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_reac])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_reac],...
    [se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_hold se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_prep ,...
    se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_reac],'.k')
set(gca,'XTick',[1:3],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Healthy Sham i05')

mc_all_phases_beta_healthy_sham_i05=nr_multcompare_ind_tdcs_plot2(f_stats_all_phases_c3_c4_beta_healthy_sham_i05,...
    f_p_all_phases_c3_c4_beta_healthy_sham_i05,0.5)

subplot(7,4,23); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_reac])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_reac],...
    [se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_hold se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_prep ,...
    se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_reac],'.k')
set(gca,'XTick',[1:3],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Healthy Sham i15')

mc_all_phases_beta_healthy_sham_i15=nr_multcompare_ind_tdcs_plot2(f_stats_all_phases_c3_c4_beta_healthy_sham_i15,...
    f_p_all_phases_c3_c4_beta_healthy_sham_i15,0.5)

subplot(7,4,27); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_reac])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_reac],...
    [se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_hold se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_prep ,...
    se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_reac],'.k')
set(gca,'XTick',[1:3],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Healthy Sham pos')

mc_all_phases_beta_healthy_sham_pos=nr_multcompare_ind_tdcs_plot2(f_stats_all_phases_c3_c4_beta_healthy_sham_pos,...
    f_p_all_phases_c3_c4_beta_healthy_sham_pos,0.5)

%healthy stim
subplot(7,4,4); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_hold ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_hold])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_hold ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_hold],...
    [se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_hold se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_hold ,...
    se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_hold se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_hold],'.k')
set(gca,'XTick',[1:4],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Healthy Stim Hold')

mc_all_times_beta_healthy_stim_hold=nr_multcompare_ind_tdcs_plot2(f_stats_all_times_c3_c4_beta_healthy_stim_hold,...
    f_p_all_times_c3_c4_beta_healthy_stim_hold,0.5)

subplot(7,4,8); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_prep mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_prep mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_prep])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_prep mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_prep mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_prep],...
    [se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_prep se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_prep ,...
    se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_prep se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_prep],'.k')
set(gca,'XTick',[1:4],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Healthy Stim Prep')

mc_all_times_beta_healthy_stim_prep=nr_multcompare_ind_tdcs_plot2(f_stats_all_times_c3_c4_beta_healthy_stim_prep,...
    f_p_all_times_c3_c4_beta_healthy_stim_prep,0.5)

subplot(7,4,12); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_reac mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_reac ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_reac mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_reac])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_reac mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_reac ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_reac mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_reac],...
    [se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_reac se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_reac ,...
    se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_reac se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_reac],'.k')
set(gca,'XTick',[1:4],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Healthy Stim Reach')

mc_all_times_beta_healthy_stim_reac=nr_multcompare_ind_tdcs_plot2(f_stats_all_times_c3_c4_beta_healthy_stim_reac,...
    f_p_all_times_c3_c4_beta_healthy_stim_reac,0.5)

subplot(7,4,16); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_reac])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_reac],...
    [se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_hold se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_prep ,...
    se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_reac],'.k')
set(gca,'XTick',[1:3],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Healthy Stim Pre')

mc_all_phases_beta_healthy_stim_pre=nr_multcompare_ind_tdcs_plot2(f_stats_all_phases_c3_c4_beta_healthy_stim_pre,...
    f_p_all_phases_c3_c4_beta_healthy_stim_pre,0.5)

subplot(7,4,20); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_reac])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_reac],...
    [se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_hold se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_prep ,...
    se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_reac],'.k')
set(gca,'XTick',[1:3],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Healthy Stim i05')

mc_all_phases_beta_healthy_stim_i05=nr_multcompare_ind_tdcs_plot2(f_stats_all_phases_c3_c4_beta_healthy_stim_i05,...
    f_p_all_phases_c3_c4_beta_healthy_stim_i05,0.5)

subplot(7,4,24); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_reac])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_reac],...
    [se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_hold se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_prep ,...
    se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_reac],'.k')
set(gca,'XTick',[1:3],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Healthy Stim i15')

mc_all_phases_beta_healthy_stim_i15=nr_multcompare_ind_tdcs_plot2(f_stats_all_phases_c3_c4_beta_healthy_stim_i15,...
    f_p_all_phases_c3_c4_beta_healthy_stim_i15,0.5)

subplot(7,4,28); hold on
bar([mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_reac])
errorbar([mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_hold mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_prep ,...
    mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_reac],...
    [se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_hold se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_prep ,...
    se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_reac],'.k')
set(gca,'XTick',[1:3],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.7])
ylabel('beta c3-c4 icoh')
title('Healthy Stim pos')

mc_all_phases_beta_healthy_stim_pos=nr_multcompare_ind_tdcs_plot2(f_stats_all_phases_c3_c4_beta_healthy_stim_pos,...
    f_p_all_phases_c3_c4_beta_healthy_stim_pos,0.5)

sgtitle(FOI_label{f})
cd(['~/nr_data_analysis/data_analyzed/eeg/gen_03/analysis_icoh/',datestr])
figname=['nr_icoh_mat_sum_bar1_sbj_all_elec_c3c4_',FOI_label{f},'_nonnorm_',datestr];
savefig(gcf,figname)
    

figure; set(gcf,'Position',[51 626 1214 571])
%stroke
subplot(7,4,1); hold on
     b(1)=bar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_hold,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_hold],0.2)
errorbar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_hold,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_hold],...
                      [se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_hold,...  
                       se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_hold,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_hold,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_hold],'.k')
     b(2)=bar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_hold,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_hold],0.2)
errorbar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_hold,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_hold],...
                      [se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_hold,...  
                       se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_hold,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_hold,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_hold],'.k')
legend('Sham','','Stim','')
set(gca,'XTick',[1 4 7 10],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.8])
ylabel('c3-c4 icoh')
title('Stroke - Hold')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_hold']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_hold']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_times.stroke.hold,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_times.stroke.hold]=mixANOVA(anovaInput,b)
clear anovaInput b

subplot(7,4,5); hold on
     b(1)=bar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_prep,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_prep],0.2)
errorbar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_prep,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_prep],...
                      [se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_prep,...  
                       se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_prep,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_prep,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_prep],'.k')
     b(2)=bar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_prep,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_prep],0.2)
errorbar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_prep,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_prep],...
                      [se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_prep,...  
                       se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_prep,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_prep,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_prep],'.k')
%legend('Sham','','Stim',''
set(gca,'XTick',[1 4 7 10],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.8])
ylabel('c3-c4 icoh')
title('Stroke - Prep')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_prep']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_prep']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_times.stroke.prep,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_times.stroke.prep]=mixANOVA(anovaInput,b)
clear anovaInput b

subplot(7,4,9); hold on
     b(1)=bar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_reac,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_reac],0.2)
errorbar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_reac,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_reac],...
                      [se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_reac,...  
                       se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_reac,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_reac,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_reac],'.k')
     b(2)=bar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_reac,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_reac],0.2)
errorbar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_reac,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_reac],...
                      [se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_reac,...  
                       se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_reac,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_reac,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_reac],'.k')
%legend('Sham','','Stim',''
set(gca,'XTick',[1 4 7 10],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.8])
ylabel('c3-c4 icoh')
title('Stroke - Reach')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_reac',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_reac',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_reac',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_reac']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_reac',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_reac',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_reac',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_reac']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_times.stroke.reac,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_times.stroke.reac]=mixANOVA(anovaInput,b)
clear anovaInput b

subplot(7,4,13); hold on
     b(1)=bar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_reac],0.2)
errorbar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_reac],'.k')
     b(2)=bar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_reac],0.2)
errorbar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_reac],'.k')
%legend('Sham','','Stim',''
set(gca,'XTick',[1 4 7],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.9])
ylabel('c3-c4 icoh')
title('Stroke - Pre')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_reac']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_reac']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_phases.stroke.pre,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_phases.stroke.pre]=mixANOVA(anovaInput,b)
clear anovaInput b

subplot(7,4,17); hold on
     b(1)=bar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_reac],0.2)
errorbar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_reac],'.k')
     b(2)=bar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_reac],0.2)
errorbar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_reac],'.k')
%legend('Sham','','Stim',''
set(gca,'XTick',[1 4 7],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.9])
ylabel('c3-c4 icoh')
title('Stroke - I05')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_reac']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_reac']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_phases.stroke.i05,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_phases.stroke.i05]=mixANOVA(anovaInput,b)
clear anovaInput b

subplot(7,4,21); hold on
     b(1)=bar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_reac],0.2)
errorbar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_reac],'.k')
     b(2)=bar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_reac],0.2)
errorbar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_reac],'.k')
%legend('Sham','','Stim',''
set(gca,'XTick',[1 4 7],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.9])
ylabel('c3-c4 icoh')
title('Stroke - I15')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_reac']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_reac']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_phases.stroke.i15,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_phases.stroke.i15]=mixANOVA(anovaInput,b)
clear anovaInput b

subplot(7,4,25); hold on
     b(1)=bar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_reac],0.2)
errorbar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_reac],'.k')
     b(2)=bar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_reac],0.2)
errorbar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_reac],'.k')
%legend('Sham','','Stim',''
set(gca,'XTick',[1 4 7],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.9])
ylabel('c3-c4 icoh')
title('Stroke - Pos')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_reac']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_reac']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_phases.stroke.pos,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_phases.stroke.pos]=mixANOVA(anovaInput,b)
clear anovaInput b

%healthy
subplot(7,4,2); hold on
     b(1)=bar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_hold,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_hold],0.2)
errorbar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_hold,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_hold],...
                      [se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_hold,...  
                       se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_hold,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_hold,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_hold],'.k')
     b(2)=bar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_hold,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_hold],0.2)
errorbar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_hold,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_hold],...
                      [se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_hold,...  
                       se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_hold,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_hold,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_hold],'.k')
%legend('Sham','','Stim',''
set(gca,'XTick',[1 4 7 10],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.8])
ylabel('c3-c4 icoh')
title('Healthy - Hold')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_hold']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_hold']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_times.healthy.hold,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_times.healthy.hold]=mixANOVA(anovaInput,b)
clear anovaInput b

subplot(7,4,6); hold on
     b(1)=bar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_prep,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_prep],0.2)
errorbar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_prep,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_prep],...
                      [se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_prep,...  
                       se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_prep,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_prep,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_prep],'.k')
     b(2)=bar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_prep,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_prep],0.2)
errorbar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_prep,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_prep],...
                      [se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_prep,...  
                       se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_prep,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_prep,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_prep],'.k')
%legend('Sham','','Stim',''
set(gca,'XTick',[1 4 7 10],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.8])
ylabel('c3-c4 icoh')
title('Healthy - Prep')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_prep']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_prep']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_times.healthy.prep,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_times.healthy.prep]=mixANOVA(anovaInput,b)
clear anovaInput b

subplot(7,4,10); hold on
     b(1)=bar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_reac,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_reac],0.2)
errorbar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_reac,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_reac],...
                      [se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_reac,...  
                       se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_reac,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_reac,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_reac],'.k')
     b(2)=bar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_reac,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_reac],0.2)
errorbar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_reac,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_reac],...
                      [se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_reac,...  
                       se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_reac,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_reac,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_reac],'.k')
%legend('Sham','','Stim',''
set(gca,'XTick',[1 4 7 10],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.8])
ylabel('c3-c4 icoh')
title('Healthy - Reach')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_reac',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_reac',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_reac',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_reac']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_reac',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_reac',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_reac',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_reac']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_times.healthy.reac,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_times.healthy.reac]=mixANOVA(anovaInput,b)
clear anovaInput b

subplot(7,4,14); hold on
     b(1)=bar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_reac],0.2)
errorbar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_reac],'.k')
     b(2)=bar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_reac],0.2)
errorbar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_reac],'.k')
%legend('Sham','','Stim',''
set(gca,'XTick',[1 4 7],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.9])
ylabel('c3-c4 icoh')
title('Healthy - Pre')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_reac']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_reac']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_phases.healthy.pre,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_phases.healthy.pre]=mixANOVA(anovaInput,b)
clear anovaInput b

subplot(7,4,18); hold on
     b(1)=bar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_reac],0.2)
errorbar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_reac],'.k')
     b(2)=bar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_reac],0.2)
errorbar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_reac],'.k')
%legend('Sham','','Stim',''
set(gca,'XTick',[1 4 7],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.9])
ylabel('c3-c4 icoh')
title('Healthy - I05')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_reac']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_reac']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_phases.healthy.i05,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_phases.healthy.i05]=mixANOVA(anovaInput,b)
clear anovaInput b

subplot(7,4,22); hold on
     b(1)=bar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_reac],0.2)
errorbar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_reac],'.k')
     b(2)=bar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_reac],0.2)
errorbar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_reac],'.k')
%legend('Sham','','Stim',''
set(gca,'XTick',[1 4 7],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.9])
ylabel('c3-c4 icoh')
title('Healthy - I15')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_reac']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_reac']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_phases.healthy.i15,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_phases.healthy.i15]=mixANOVA(anovaInput,b)
clear anovaInput b

subplot(7,4,26); hold on
     b(1)=bar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_reac],0.2)
errorbar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_reac],'.k')
     b(2)=bar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_reac],0.2)
errorbar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_reac],'.k')
%legend('Sham','','Stim',''
set(gca,'XTick',[1 4 7],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.9])
ylabel('c3-c4 icoh')
title('Healthy - Pos')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_reac']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_reac']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_phases.healthy.pos,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_phases.healthy.pos]=mixANOVA(anovaInput,b)
clear anovaInput b

%sham 
subplot(7,4,3); hold on
     b(1)=bar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_hold,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_hold],0.2)
errorbar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_hold,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_hold],...
                      [se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_hold,...  
                       se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_hold,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_hold,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_hold],'.k')
     b(2)=bar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_hold,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_hold],0.2)
errorbar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_hold,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_hold],...
                      [se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_hold,...  
                       se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_hold,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_hold,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_hold],'.k')
legend('Stroke','','Healthy','')
set(gca,'XTick',[1 4 7 10],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.9])
ylabel('c3-c4 icoh')
title('Sham - Hold')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_hold']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_hold']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_times.sham.hold,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_times.sham.hold]=mixANOVA(anovaInput,b)
clear anovaInput b

subplot(7,4,7); hold on
     b(1)=bar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_prep,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_prep],0.2)
errorbar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_prep,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_prep],...
                      [se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_prep,...  
                       se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_prep,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_prep,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_prep],'.k')
     b(2)=bar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_prep,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_prep],0.2)
errorbar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_prep,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_prep],...
                      [se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_prep,...  
                       se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_prep,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_prep,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_prep],'.k')
%legend('Stroke','','Healthy','')
set(gca,'XTick',[1 4 7 10],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.9])
ylabel('c3-c4 icoh')
title('Sham - Prep')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_prep']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_prep']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_times.sham.prep,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_times.sham.prep]=mixANOVA(anovaInput,b)
clear anovaInput b

subplot(7,4,11); hold on
     b(1)=bar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_reac,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_reac],0.2)
errorbar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_reac,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_reac],...
                      [se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_reac,...  
                       se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_reac,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_reac,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_reac],'.k')
     b(2)=bar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_reac,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_reac],0.2)
errorbar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_reac,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_reac],...
                      [se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_reac,...  
                       se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_reac,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_reac,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_reac],'.k')
%legend('Stroke','','Healthy','')
set(gca,'XTick',[1 4 7 10],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.9])
ylabel('c3-c4 icoh')
title('Sham - Reach')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_reac',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_reac',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_reac',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_reac']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_reac',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_reac',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_reac',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_reac']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_times.sham.reac,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_times.sham.reac]=mixANOVA(anovaInput,b)
clear anovaInput b
 
subplot(7,4,15); hold on
     b(1)=bar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_reac],0.2)
errorbar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_reac],'.k')
     b(2)=bar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_reac],0.2)
errorbar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_reac],'.k')
%legend('Stroke','','Healthy','')
set(gca,'XTick',[1 4 7],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.9])
ylabel('c3-c4 icoh')
title('Sham - Pre')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_pre_reac']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_pre_reac']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_phases.sham.pre,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_phases.sham.pre]=mixANOVA(anovaInput,b)
clear anovaInput b

subplot(7,4,19); hold on
     b(1)=bar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_reac],0.2)
errorbar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_reac],'.k')
     b(2)=bar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_reac],0.2)
errorbar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_reac],'.k')
%legend('Stroke','','Healthy','')
set(gca,'XTick',[1 4 7],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.9])
ylabel('c3-c4 icoh')
title('Sham - I05')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_i05_reac']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_i05_reac']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_phases.sham.i05,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_phases.sham.i05]=mixANOVA(anovaInput,b)
clear anovaInput b

subplot(7,4,23); hold on
     b(1)=bar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_reac],0.2)
errorbar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_reac],'.k')
     b(2)=bar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_reac],0.2)
errorbar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_reac],'.k')
%legend('Stroke','','Healthy','')
set(gca,'XTick',[1 4 7],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.9])
ylabel('c3-c4 icoh')
title('Sham - I15')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_i15_reac']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_i15_reac']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_phases.sham.i15,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_phases.sham.i15]=mixANOVA(anovaInput,b)
clear anovaInput b

subplot(7,4,27); hold on
     b(1)=bar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_reac],0.2)
errorbar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_reac],'.k')
     b(2)=bar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_reac],0.2)
errorbar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_reac],'.k')
%legend('Stroke','','Healthy','')
set(gca,'XTick',[1 4 7],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.9])
ylabel('c3-c4 icoh')
title('Sham - Pos')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_sham_pos_reac']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_sham_pos_reac']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_phases.sham.pos,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_phases.sham.pos]=mixANOVA(anovaInput,b)
clear anovaInput b

%stim 
subplot(7,4,4); hold on
     b(1)=bar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_hold,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_hold],0.2)
errorbar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_hold,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_hold],...
                      [se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_hold,...  
                       se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_hold,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_hold,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_hold],'.k')
     b(2)=bar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_hold,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_hold],0.2)
errorbar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_hold,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_hold,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_hold],...
                      [se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_hold,...  
                       se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_hold,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_hold,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_hold],'.k')
%legend('Stroke','','Healthy','')
set(gca,'XTick',[1 4 7 10],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.9])
ylabel('c3-c4 icoh')
title('Stim - Hold')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_hold']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_hold']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_times.stim.hold,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_times.stim.hold]=mixANOVA(anovaInput,b)
clear anovaInput b

subplot(7,4,8); hold on
     b(1)=bar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_prep,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_prep],0.2)
errorbar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_prep,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_prep],...
                      [se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_prep,...  
                       se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_prep,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_prep,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_prep],'.k')
     b(2)=bar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_prep,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_prep],0.2)
errorbar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_prep,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_prep,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_prep],...
                      [se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_prep,...  
                       se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_prep,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_prep,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_prep],'.k')
%legend('Stroke','','Healthy','')
set(gca,'XTick',[1 4 7 10],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.9])
ylabel('c3-c4 icoh')
title('Stim - Prep')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_prep']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_prep']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_times.stim.prep,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_times.stim.prep]=mixANOVA(anovaInput,b)
clear anovaInput b

subplot(7,4,12); hold on
     b(1)=bar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_reac,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_reac],0.2)
errorbar([1,4,7,10],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_reac,...  
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_reac],...
                      [se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_reac,...  
                       se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_reac,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_reac,... 
                       se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_reac],'.k')
     b(2)=bar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_reac,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_reac],0.2)
errorbar([2,5,8,11],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_reac,...  
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_reac,... 
                     mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_reac],...
                      [se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_reac,...  
                       se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_reac,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_reac,... 
                       se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_reac],'.k')
%legend('Stroke','','Healthy','')
set(gca,'XTick',[1 4 7 10],'XTickLabel',{'pre';'i05';'i15';'pos'},'YLim',[0.5 0.9])
ylabel('c3-c4 icoh')
title('Stim - Reach')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_reac',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_reac',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_reac',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_reac']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_reac',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_reac',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_reac',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_reac']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_times.stim.reac,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_times.stim.reac]=mixANOVA(anovaInput,b)
clear anovaInput b
 
subplot(7,4,16); hold on
     b(1)=bar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_reac],0.2)
errorbar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_reac],'.k')
     b(2)=bar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_reac],0.2)
errorbar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_reac],'.k')
%legend('Stroke','','Healthy','')
set(gca,'XTick',[1 4 7],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.9])
ylabel('c3-c4 icoh')
title('Stim - Pre')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_pre_reac']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_pre_reac']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_phases.stim.pre,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_phases.stim.pre]=mixANOVA(anovaInput,b)
clear anovaInput b

subplot(7,4,20); hold on
     b(1)=bar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_reac],0.2)
errorbar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_reac],'.k')
     b(2)=bar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_reac],0.2)
errorbar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_reac],'.k')
%legend('Stroke','','Healthy','')
set(gca,'XTick',[1 4 7],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.9])
ylabel('c3-c4 icoh')
title('Stim - I05')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_i05_reac']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_i05_reac']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_phases.stim.i05,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_phases.stim.i05]=mixANOVA(anovaInput,b)
clear anovaInput b

subplot(7,4,24); hold on
     b(1)=bar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_reac],0.2)
errorbar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_reac],'.k')
     b(2)=bar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_reac],0.2)
errorbar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_reac],'.k')
%legend('Stroke','','Healthy','')
set(gca,'XTick',[1 4 7],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.9])
ylabel('c3-c4 icoh')
title('Stim - I15')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_i15_reac']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_i15_reac']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_phases.stim.i15,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_phases.stim.i15]=mixANOVA(anovaInput,b)
clear anovaInput b

subplot(7,4,28); hold on
     b(1)=bar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_reac],0.2)
errorbar([1,4,7],[mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_reac],'.k')
     b(2)=bar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_reac],0.2)
errorbar([2,5,8],[mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_hold,...  
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_prep,... 
                  mean_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_reac],...
                   [se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_hold,...  
                    se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_prep,... 
                    se_all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_reac],'.k')
%legend('Stroke','','Healthy','')
set(gca,'XTick',[1 4 7],'XTickLabel',{'hold';'prep';'reac'},'YLim',[0.5 0.9])
ylabel('c3-c4 icoh')
title('Stim - Pos')

anovaInput{1,1}=[all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_hold',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_prep',...
    all_imagescDat_ind_c3_c4_beta_stroke_stim_pos_reac']
anovaInput{1,2}=[all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_hold',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_prep',...
    all_imagescDat_ind_c3_c4_beta_healthy_stim_pos_reac']
[icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc1.all_phases.stim.pos,...
    icoh_data_anal.stats.icoh_mat.c3c4.mixanova.mc2.all_phases.stim.pos]=mixANOVA(anovaInput,b)
clear anovaInput b


sgtitle(FOI_label{f})
cd(['~/nr_data_analysis/data_analyzed/eeg/gen_03/analysis_icoh/',datestr])
figname=['nr_icoh_mat_sum_bar2_sbj_all_elec_c3c4_',FOI_label{f},'_nonnorm_',datestr];
savefig(gcf,figname)


end
           


